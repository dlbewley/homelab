#!/bin/bash
# symlink to oc version using dir structure laid down by getoc

INSTALL_DIR=$HOME/bin
CLIENTS="oc kubectl"
version=$1

if [ ! -r "${INSTALL_DIR}/oc-${version}" ]; then
    echo "Version $version does not exist. Did you run getoc"
    exit 1
fi

if [ $(uname) == "Darwin" ]; then
    platform="macosx"
else
    platform="linux"
fi

echo "Linking clients to ${version}/${platform}"
for client in $CLIENTS; do
    rm -f "$INSTALL_DIR/$client"
    ln -s "$INSTALL_DIR/oc-${version}/${platform}/oc" "$INSTALL_DIR/${client}"
done

version=latest
echo "Linking helm to ${version}/${platform}"
if [ "$platform" == "macosx" ]; then
    platform="darwin"
fi
for client in helm; do
    rm -f "$INSTALL_DIR/$client"
    ln -s "$INSTALL_DIR/helm-${version}/${platform}/helm" "$INSTALL_DIR/${client}"
done
